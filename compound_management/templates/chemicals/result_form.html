{% extends 'base.html' %}
{% block title %}Add result Data{% endblock %}
{% block extra_head %}

{% endblock %}
{% block content %}

<div class="row">
    <div class="col-lg-6">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title">{{ target }}</h4>
            <table class="table table-hover" id="sourceTable">
                <thead>
                <tr>
                    <th></th>
                    <th>chem_ID</th>
                    <th>MW</th>
                    <th>cLogP</th>
                    <th>TPSA</th>
    <!--                <th>H_donors</th>-->
    <!--                <th>H_acceptors</th>-->
    <!--                <th>lipinski</th>-->
                </tr>
                </thead>
                <tbody>
                {% for chem in chemicals %}
                <tr>
                    <td><input type="checkbox" class="data-checkbox"></td>
                    <td data-id ={{chem.chem_id}} >{{ chem.chem_id }}</td>
                    <td>{{ chem.MW }}</td>
                    <td>{{ chem.cLogP }}</td>
                    <td>{{ chem.TPSA }}</td>
        <!--                <td>{{ chem.H_donors }}</td>-->
        <!--                <td>{{ chem.H_acceptors }}</td>-->
        <!--                <td>{{ chem.lipinski }}</td>-->
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
      </div>
    </div>
    <div class="col-lg-6">
        <div class="card">
            <div class="card-body">
              <h5 class="card-title">Add result</h5>

              <!-- Default Tabs -->
              <ul class="nav nav-tabs d-flex" id="myTabjustified" role="tablist">
                <li class="nav-item flex-fill" role="presentation">
                  <button class="nav-link w-100 active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home-justified" type="button" role="tab" aria-controls="home" aria-selected="true">Chemical Property</button>
                </li>
                <li class="nav-item flex-fill" role="presentation">
                  <button class="nav-link w-100" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile-justified" type="button" role="tab" aria-controls="profile" aria-selected="false">In vitro assay</button>
                </li>
                <li class="nav-item flex-fill" role="presentation">
                  <button class="nav-link w-100" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact-justified" type="button" role="tab" aria-controls="contact" aria-selected="false">In vivo assay</button>
                </li>
              </ul>

            <div class="tab-content pt-2" id="myTabjustifiedContent">
                <div class="tab-pane fade show active" id="home-justified" role="tabpanel" aria-labelledby="home-tab">
                      Sunt est soluta temporibus accusantium neque nam maiores cumque temporibus. Tempora libero non est unde veniam est qui dolor. Ut sunt iure rerum quae quisquam autem eveniet perspiciatis odit. Fuga sequi sed ea saepe at unde.
                </div>
                <div class="tab-pane fade" id="profile-justified" role="tabpanel" aria-labelledby="profile-tab">

                    <form method="POST">
                    {% csrf_token %}
                    {% for db_name in db_names %}
<!--                       {% if db_name.group == 'in_vitro' %}-->
                        <label>
                            <input type="radio" name="dbOption" value="{{ db_name}}" class="db-radio"> {{ db_name}}
                        </label>
<!--                       {% endif %}-->
                    {% endfor %}
                        <table id="resultTable">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                        <input type="text" name="data_field" placeholder="Enter data to save" required>
                        <button type="submit">Save Data</button>
                    </form>

                </div>


                <div class="tab-pane fade" id="contact-justified" role="tabpanel" aria-labelledby="contact-tab">
                  Saepe animi et soluta ad odit soluta sunt. Nihil quos omnis animi debitis cumque. Accusantium quibusdam perspiciatis qui qui omnis magnam. Officiis accusamus impedit molestias nostrum veniam. Qui amet ipsum iure. Dignissimos fuga tempore dolor.
                </div>

            </div><!-- End Default Tabs -->
            </div>
        </div>
    </div>
</div>



{% endblock %}
{% block extra_js %}
<script>
$(document).ready(function() {

     $('.db-radio').on('change', function() {
            console.log($(this).val()); // 선택된 체크박스의 값을 콘솔에 출력
     });

    // 페이지가 로드될 때, 저장된 탭 상태를 복원
    var activeTab = localStorage.getItem('activeTab');
    if (activeTab) {
        var $tabElement = $(activeTab);
        if ($tabElement.length) {
            $tabElement.click();
        }
    }

    // 탭 클릭 시, 로컬 스토리지에 상태 저장
    $('.tab-link').on('click', function() {
        var target = $(this).attr('href');
        localStorage.setItem('activeTab', target);
    });
});

function updateResultTable() {
    const $resultTableBody = $('#resultTable tbody');
    $resultTableBody.empty();

    $('.data-checkbox:checked').each(function() {
        var $row = $(this).closest("tr")
        const data = $row.find("td[data-id]").data("id");
        const $newRow = $('<tr></tr>');
        const $cell = $('<td></td>').text(data);
        $newRow.append($cell);
        $resultTableBody.append($newRow);
    });
}

$(document).on('change', '.data-checkbox', updateResultTable);


</script>
{% endblock %}